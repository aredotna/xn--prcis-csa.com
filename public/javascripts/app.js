(function(){"use strict";var a=typeof window!="undefined"?window:global;if(typeof a.require=="function")return;var b={},c={},d=function(a,b){return{}.hasOwnProperty.call(a,b)},e=function(a,b){var c=[],d,e;/^\.\.?(\/|$)/.test(b)?d=[a,b].join("/").split("/"):d=b.split("/");for(var f=0,g=d.length;f<g;f++)e=d[f],e===".."?c.pop():e!=="."&&e!==""&&c.push(e);return c.join("/")},f=function(a){return a.split("/").slice(0,-1).join("/")},g=function(b){return function(c){var d=f(b),g=e(d,c);return a.require(g)}},h=function(a,b){var d={id:a,exports:{}};b(d.exports,g(a),d);var e=c[a]=d.exports;return e},i=function(a){var f=e(a,".");if(d(c,f))return c[f];if(d(b,f))return h(f,b[f]);var g=e(f,"./index");if(d(c,g))return c[g];if(d(b,g))return h(g,b[g]);throw new Error('Cannot find module "'+a+'"')},j=function(a){for(var c in a)d(a,c)&&(b[c]=a[c])};a.require=i,a.require.define=j,a.require.brunch=!0})(),window.require.define({"collections/blocks":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("models/block").Block,a.Blocks=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.model=c,b.prototype.comparator=function(a){return a.get("position")},b.prototype.next=function(a){return this.at((this.indexOf(a)+1)%_.size(this.models))},b.prototype.prev=function(a){var b;return b=this.indexOf(a)-1,this.at(b>-1?b:_.size(this.models)-1)},b}(Backbone.Collection)})).call(this)}}),window.require.define({helpers:function(a,b,c){((function(){a.BrunchApplication=function(){function a(){var a=this;$(function(){return a.initialize(a),Backbone.history.start()})}return a.prototype.initialize=function(){return null},a.prototype.parseReferrer=function(){var a;return a=document.createElement("a"),a.href=document.referrer,a},a.prototype.loading=function(){return{start:function(){return $("body").html("").removeClass("error").addClass("loading")},stop:function(){return $("body").removeClass("error").removeClass("loading")},error:function(){return $("body").removeClass("loading").addClass("error")}}},a}()})).call(this)}}),window.require.define({initialize:function(a,b,c){((function(){var c,d,e,f=Object.prototype.hasOwnProperty,g=function(a,b){function d(){this.constructor=a}for(var c in b)f.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c=b("helpers").BrunchApplication,d=b("routers/main_router").MainRouter,e=b("views/shortcuts").Shortcuts,a.Application=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.initialize=function(){return this.loading().start(),this.router=new d,this.shortcuts=new e},b}(c),window.app=new a.Application})).call(this)}}),window.require.define({"models/block":function(a,b,c){((function(){var b=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};a.Block=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.initialize=function(){return this.checkIfMissingImage()},b.prototype.checkIfMissingImage=function(){var a;a="/assets/interface/missing.png";if(this.get("image_thumb")===a)return this.set("image_thumb",null)},b.prototype.next=function(){return this.collection.next(this)},b.prototype.prev=function(){return this.collection.prev(this)},b}(Backbone.Model)})).call(this)}}),window.require.define({"models/channel":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("collections/blocks").Blocks,a.Channel=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.url=function(){return"http://api.are.na/v2/channels/"+this.get("slug")},b.prototype.maybeLoad=function(a){var b=this;return a===this.get("slug")?!0:(this.clear(),app.loading().start(),this.set("slug",a),this.set("fetching",!0),this.fetch({success:function(){return b.setupBlocks(),b.set("fetching",!1),app.loading().stop(),!0},error:function(){return app.loading().error()}}))},b.prototype.setupBlocks=function(){return this.blocks=new c(this.get("contents"))},b}(Backbone.Model)})).call(this)}}),window.require.define({"routers/main_router":function(a,b,c){((function(){var c,d,e,f,g,h=Object.prototype.hasOwnProperty,i=function(a,b){function d(){this.constructor=a}for(var c in b)h.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};f=b("views/index_view").IndexView,c=b("views/block_view").BlockView,g=b("views/single_view").SingleView,e=b("views/collection_view").CollectionView,d=b("models/channel").Channel,a.MainRouter=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.routes={"":"index","/:slug":"collection","/:slug/overview":"overview","/:slug/show::id":"single"},b.prototype.initialize=function(){return this.channel=new d},b.prototype.redirectToChannel=function(){var a;if(app.parseReferrer().host==="are.na"){a=app.parseReferrer().pathname.split("/")[1];if(!/show:/.test(a))return this.navigate("//"+a+"/overview",{trigger:!0})}},b.prototype.index=function(){return this.indexView=new f,$("body").html(this.indexView.render().el),app.loading().stop(),this.redirectToChannel()},b.prototype.collection=function(a){var b=this;return $.when(this.channel.maybeLoad(a)).then(function(){return b.navigate("//"+a+"/show:"+b.channel.blocks.at(0).id,{trigger:!0})})},b.prototype.overview=function(a){var b=this;return $.when(this.channel.maybeLoad(a)).then(function(){return app.currentChannel=b.channel,app.currentCollection=b.channel.blocks,b.collectionView=new e({model:b.channel,collection:b.channel.blocks,mode:"grid"}),$("body").attr("class","collection").html(b.collectionView.render().el)})},b.prototype.single=function(a,b){var c=this;return $.when(this.channel.maybeLoad(a)).then(function(){return c.singleView=new g({model:c.channel.blocks.get(b),collection:c.channel.blocks,channel:c.channel}),$("body").attr("class","single").html(c.singleView.render().el)})},b}(Backbone.Router)})).call(this)}}),window.require.define({"views/block_view":function(a,b,c){((function(){var c=Object.prototype.hasOwnProperty,d=function(a,b){function e(){this.constructor=a}for(var d in b)c.call(b,d)&&(a[d]=b[d]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};a.BlockView=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return d(c,a),c.prototype.className="block",c.prototype.initialize=function(){return this.template=b("./templates/single/"+this.options.mode)},c.prototype.render=function(){return this.$el.html(this.template({mode:this.options.mode,channel:this.options.channel.toJSON(),block:this.model.toJSON()})),this},c}(Backbone.View)})).call(this)}}),window.require.define({"views/collection_view":function(a,b,c){((function(){var c,d=function(a,b){return function(){return a.apply(b,arguments)}},e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};c=b("views/block_view").BlockView,a.CollectionView=function(a){function e(){this.addOne=d(this.addOne,this),e.__super__.constructor.apply(this,arguments)}return f(e,a),e.prototype.id="collection",e.prototype.initialize=function(){return document.title=this.model.get("title"),this.template=b("./templates/collection/"+this.options.mode)},e.prototype.addAll=function(){return this.collection.each(this.addOne)},e.prototype.addOne=function(a){var b;return b=new c({mode:this.options.mode,model:a,collection:this.model.blocks,channel:this.model}),this.$("#blocks").append(b.render().el)},e.prototype.render=function(){return this.$el.html(this.template({channel:this.model.toJSON(),blocks:this.collection.toJSON()})),this.addAll(),this},e}(Backbone.View)})).call(this)}}),window.require.define({"views/index_view":function(a,b,c){((function(){var c,d=Object.prototype.hasOwnProperty,e=function(a,b){function e(){this.constructor=a}for(var c in b)d.call(b,c)&&(a[c]=b[c]);return e.prototype=b.prototype,a.prototype=new e,a.__super__=b.prototype,a};c=b("./templates/index"),a.IndexView=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.id="index",b.prototype.className="home",b.prototype.events={"submit #channel":"go"},b.prototype.initialize=function(){return document.title="Précis"},b.prototype.to_slug=function(a){var b,c,d,e;a=a.replace(/^\s+|\s+$/g,"").toLowerCase(),b="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",d="aaaaeeeeiiiioooouuuunc------";for(c=c,e=b.length;c<=e?c<=e:c>=e;c<=e?c++:c--)a=a.replace(new RegExp(b.charAt(c),"g"),d.charAt(c));return a=a.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),a},b.prototype.go=function(a){var b;return a.preventDefault(),b=this.$("#channel_slug").val(),app.router.navigate("//"+this.to_slug(b)+"/overview",{trigger:!0})},b.prototype.render=function(){return this.$el.html(c),this},b}(Backbone.View)})).call(this)}}),window.require.define({"views/shortcuts":function(a,b,c){((function(){var b=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};a.Shortcuts=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return c(b,a),b.prototype.shortcuts={left:"prev",right:"next",up:"up"},b.prototype.next=function(){var a;return a=app.currentCollection.next(app.currentBlock),window.location.hash="#/"+app.currentChannel.get("slug")+"/show:"+a.id},b.prototype.prev=function(){var a;return a=app.currentCollection.prev(app.currentBlock),window.location.hash="#/"+app.currentChannel.get("slug")+"/show:"+a.id},b.prototype.up=function(){return window.location.hash="#/"+app.currentChannel.get("slug")+"/overview"},b}(Backbone.Shortcuts)})).call(this)}}),window.require.define({"views/single_view":function(a,b,c){((function(){var c,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=b("./templates/single/list"),c=b("views/block_view").BlockView,a.SingleView=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.id="single",b.prototype.className="block",b.prototype.initialize=function(){return this.channel=this.options.channel,app.currentChannel=this.channel,app.currentBlock=this.model,app.currentCollection=this.collection,document.title=this.model.get("title")?""+this.channel.get("title")+": "+this.model.get("title"):this.channel.get("title")},b.prototype.render=function(a){var b=this;return this.$el.html(d({channel:this.channel.toJSON(),block:this.model.toJSON(),blocks:this.collection.toJSON(),next:this.collection.next(this.model),prev:this.collection.prev(this.model)})),this.$el.waitForImages(function(){return b.$(".slide").removeClass("loading"),b.$(".slide").addClass("done")}),this},b}(c)})).call(this)}}),window.require.define({"views/templates/collection/grid":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<div class="area">\n  <header class="information">\n    <section class="title">\n      <a class=\'btn\' href="/#/'),b.push(d(this.channel.slug)),b.push('">'),b.push(d(this.channel.title)),b.push('</a>\n    </section>\n  </header>\n</div>\n\n<div id="blocks" class="grid"></div>')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),window.require.define({"views/templates/collection/list":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push("<h1>"),b.push(d(this.channel.title)),b.push('</h1>\n\n<div id="blocks" class="list"></div>')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),window.require.define({"views/templates/collection/slideshow":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push("<h1>"),b.push(d(this.channel.title)),b.push('</h1>\n\n<div id="blocks" class="slideshow"></div>')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),window.require.define({"views/templates/index":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<div class="slide">\n  <div class="wrap">\n    <form id="channel" class="middle">\n      <span id="url_base">http://are.na/</span>\n      <input id="channel_slug" tabindex="0" type="text" placeholder="channel-title" />\n    </form>\n  </div>\n</div>')})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),window.require.define({"views/templates/single/grid":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){this.block.base_class==="Block"&&(b.push("\n  "),this.block.image?(b.push('\n    <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">\n      <!-- <span class="thumb" style="background-image:url('),b.push(d(this.block.image.thumb.url)),b.push(')"></span> -->\n      <img src="'),b.push(d(this.block.image.thumb.url)),b.push('" alt="'),b.push(d(this.block.id)),b.push('" />\n    </a>\n  ')):this.block.title?(b.push('\n    <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('" class="text">\n      '),b.push(d(_.str.prune(this.block.title,20))),b.push("\n    </a>\n  ")):(b.push('\n    <a href="/#/'),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('" class="text">\n      Untitled\n    </a>\n  ')),b.push("\n")),b.push("\n\n"),this.block["class"]==="Channel"&&this.block.published&&(b.push('\n  <a href="/#/'),b.push(d(this.block.slug)),b.push('/overview" class="channel">\n    '),b.push(d(_.str.prune(this.block.title,20))),b.push("\n  </a>\n")),b.push("\n\n")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}}),window.require.define({"views/templates/single/list":function(a,b,c){c.exports=function(a){a||(a={});var b=[],c=function(a){var c=b,d;return b=[],a.call(this),d=b.join(""),b=c,e(d)},d=function(a){return a&&a.ecoSafe?a:typeof a!="undefined"&&a!=null?g(a):""},e,f=a.safe,g=a.escape;return e=a.safe=function(a){if(a&&a.ecoSafe)return a;if(typeof a=="undefined"||a==null)a="";var b=new String(a);return b.ecoSafe=!0,b},g||(g=a.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){((function(){b.push('<section class="area">\n  ');if(this.prev||this.next)b.push("\n    <nav class='pagination'>\n      "),this.prev&&(b.push("\n        <a class='prev btn' href=\"/#/"),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.prev.id)),b.push('">Previous</a>\n      ')),b.push("\n\n      <a class='btn' href=\"/#/"),b.push(d(this.channel.slug)),b.push('/overview">Up</a>\n\n      '),this.next&&(b.push("\n        <a class='next btn' href=\"/#/"),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.next.id)),b.push('">Next</a>\n      ')),b.push("\n    </nav>\n  ");b.push('\n\n  <header class="information">\n    <section class="title">\n      '),this.block.title?(b.push("\n        <a class='btn' href=\"/#/"),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">'),b.push(d(_.str.prune(this.block.title,50))),b.push("</a>\n      ")):(b.push("\n        <a class='btn' href=\"/#/"),b.push(d(this.channel.slug)),b.push("/show:"),b.push(d(this.block.id)),b.push('">¶</a>\n      ')),b.push("\n    </section>\n\n    ");if(this.block.description||this.block.source_url)b.push('\n      <section class="metadata">\n        '),this.block.description&&(b.push('\n          <div class="description">\n            '),b.push(this.block.description_html),b.push("\n          </div>\n        ")),b.push("\n\n        "),this.block.source_url&&(b.push('\n          <div class="source-url">\n            <strong>Source:</strong>\n            <a href="'),b.push(this.block.source_url),b.push('" target="_blank">\n              '),b.push(_.str.prune(this.block.source_url,50)),b.push("\n            </a>\n          </div>\n        ")),b.push("\n      </section>\n    ");b.push('\n  </header>\n</section>\n\n<div id="block_'),b.push(d(this.block.id)),b.push('" class="full '),b.push(d(this.block["class"].toLowerCase())),b.push('" data-type="'),b.push(d(this.block["class"])),b.push('">\n  '),this.block["class"]==="Media"?(b.push('\n    <div class="embed occupy">\n      '),b.push(this.block.embed_html),b.push("\n    </div>\n\n  ")):this.block["class"]==="Link"?(b.push('\n    <div class="link occupy">\n      <iframe src="'),b.push(d(this.block.source_url)),b.push('" width="100%" height="100%" />\n    </div>\n\n  ')):this.block["class"]==="Image"?(b.push('\n    <div class="image loading slide">\n      <div class="wrap">\n        <a href="'),b.push(d(this.block.image.original.url)),b.push('" class="middle" target="_blank">\n          <img src="'),b.push(d(this.block.image.display.url)),b.push('" alt="'),b.push(d(this.block.title)),b.push('" />\n        </a>\n      </div>\n    </div>\n\n  ')):this.block["class"]==="Text"&&(b.push('\n    <div class="text slide">\n      <div class="wrap">\n        <div class="middle">\n          <div class="content">'),b.push(this.block.content_html),b.push("</div>\n        </div>\n      </div>\n    </div>\n  ")),b.push("\n</div>")})).call(this)}.call(a),a.safe=f,a.escape=g,b.join("")}}})